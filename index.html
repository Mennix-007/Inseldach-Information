<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Inseldachdecker – Info</title>
  <style>
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#0b0f14;color:#e9eef5}
    .wrap{display:grid;grid-template-columns:1.2fr 0.8fr;gap:24px;padding:24px;height:100vh;box-sizing:border-box}
    .card{background:#121a24;border:1px solid #223045;border-radius:16px;padding:20px}
    .top{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .logo{height:64px;object-fit:contain}
    .time{text-align:right}
    .time .clock{font-size:44px;font-weight:700}
    .time .date{font-size:18px;opacity:.85}
    h2{margin:0 0 12px;font-size:26px}
    ul{margin:0;padding-left:22px;font-size:22px;line-height:1.35}
    li{margin:8px 0}
    .ticker{position:fixed;left:0;right:0;bottom:0;background:#0a0f16;border-top:1px solid #223045;height:64px;display:flex;align-items:center;overflow:hidden}
    .ticker .inner{white-space:nowrap;will-change:transform;font-size:28px;padding-left:100%}
    .hint{font-size:18px;opacity:.8}

    /* QR */
    .qrBox{display:flex;gap:18px;align-items:center}
    #qrcode{width:160px;height:160px;background:#fff;padding:10px;border-radius:12px}
    .qrText{font-size:18px;opacity:.9}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <!-- Logo später: logo.png -->
        <div style="font-size:26px;font-weight:700">Inseldachdecker</div>

        <div class="time">
          <div class="clock" id="clock">--:--</div>
          <div class="date" id="date">--.--.----</div>
        </div>
      </div>

      <hr style="border:0;border-top:1px solid #223045;margin:18px 0;">

      <h2>Heute wichtig</h2>
      <ul id="heuteWichtig"></ul>

      <div class="hint" style="margin-top:16px;">
        Aktualisierung: alle 60 Sekunden (aus news.json)
      </div>
    </div>

    <div class="card">
      <h2>QR-Code</h2>
      <div class="qrBox">
        <div id="qrcode"></div>
        <div class="qrText">
          <div id="qrLabel">Scannen für Handy-Ansicht</div>
          <div style="opacity:0.75;margin-top:8px;" id="qrSub"></div>
        </div>
      </div>

      <hr style="border:0;border-top:1px solid #223045;margin:18px 0;">

      <div class="hint">
        Nächster Schritt: Wetter (Borkum).
      </div>
    </div>
  </div>

  <div class="ticker">
    <div class="inner" id="tickerInner">…</div>
  </div>

  <!-- QRCode Lib -->
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

  <script>
    function tickTime() {
      const now = new Date();
      const pad = n => String(n).padStart(2, '0');
      document.getElementById('clock').textContent = `${pad(now.getHours())}:${pad(now.getMinutes())}`;
      document.getElementById('date').textContent =
        now.toLocaleDateString('de-DE', { weekday:'long', year:'numeric', month:'2-digit', day:'2-digit' });
    }

    async function loadNews() {
      const res = await fetch('news.json?ts=' + Date.now());
      const data = await res.json();

      // Heute wichtig
      const ul = document.getElementById('heuteWichtig');
      ul.innerHTML = '';
      (data.heuteWichtig || []).forEach(t => {
        const li = document.createElement('li');
        li.textContent = t;
        ul.appendChild(li);
      });

      // Ticker
      const tickerText = (data.ticker || []).join('  •  ');
      const inner = document.getElementById('tickerInner');
      inner.textContent = tickerText || '—';

      // QR-Code (Link zur aktuellen Seite)
      const url = location.href;
      document.getElementById('qrSub').textContent = url;

      const qr = document.getElementById('qrcode');
      qr.innerHTML = '';
      new QRCode(qr, { text: url, width: 160, height: 160 });
    }

    function startTicker() {
      const el = document.getElementById('tickerInner');
      let x = window.innerWidth;

      function anim() {
        x -= 2;
        el.style.transform = `translateX(${x}px)`;
        const w = el.getBoundingClientRect().width;
        if (x < -w) x = window.innerWidth;
        requestAnimationFrame(anim);
      }
      requestAnimationFrame(anim);
    }

    // Start
    tickTime();
    setInterval(tickTime, 1000);

    loadNews();
    setInterval(loadNews, 60000);

    startTicker();
  </script>
</body>
</html>
